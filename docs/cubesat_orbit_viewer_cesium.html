<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>üõ∞Ô∏è CubeSat Orbit Viewer (CesiumJS)</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.109/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.109/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
  <style>
    html, body, #cesiumContainer {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      font-family: sans-serif;
    }
    #controls {
      position: absolute;
      top: 10px;
      left: 10px;
      background: white;
      padding: 10px;
      z-index: 1;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <div id="controls">
    <label for="orbitMode">Select Orbit:</label>
    <select id="orbitMode">
      <option value="LEO">LEO (500 km)</option>
      <option value="SSO">SSO (700 km)</option>
      <option value="ELLIPTICAL">Elliptical (Molniya)</option>
    </select>
    <button onclick="loadOrbit()">üöÄ Show Orbit</button>
    <p id="status" style="font-size: 0.9em;"></p>
  </div>

  <script>
    const viewer = new Cesium.Viewer("cesiumContainer", {
      shouldAnimate: true,
      timeline: false,
      animation: false,
      terrainProvider: Cesium.createWorldTerrain(),
    });

    let satellite;

    function loadOrbit() {
      if (satellite) viewer.entities.remove(satellite);

      const mode = document.getElementById("orbitMode").value;
      let altitude = 500, inclination = 51.6;

      if (mode === "SSO") {
        altitude = 700;
        inclination = 98.6;
      } else if (mode === "ELLIPTICAL") {
        altitude = 500;
        inclination = 63.4;
      }

      const start = Cesium.JulianDate.fromDate(new Date());
      const stop = Cesium.JulianDate.addMinutes(start, 90, new Cesium.JulianDate());

      viewer.clock.startTime = start.clone();
      viewer.clock.stopTime = stop.clone();
      viewer.clock.currentTime = start.clone();
      viewer.clock.clockRange = Cesium.ClockRange.LOOP_STOP;
      viewer.clock.multiplier = 60;

      const property = new Cesium.SampledPositionProperty();

      for (let i = 0; i <= 90; i += 1) {
        const time = Cesium.JulianDate.addMinutes(start, i, new Cesium.JulianDate());
        const lon = (i * 4) % 360;
        const lat = inclination * Math.sin(i / 90 * Math.PI);
        const pos = Cesium.Cartesian3.fromDegrees(lon, lat, altitude * 1000);
        property.addSample(time, pos);
      }

      satellite = viewer.entities.add({
        position: property,
        point: { pixelSize: 10, color: Cesium.Color.CYAN },
        path: {
          resolution: 60,
          material: Cesium.Color.YELLOW,
          width: 2
        }
      });

      viewer.trackedEntity = satellite;
      document.getElementById("status").innerText = `Orbit Viewer: Simulated ${mode} pass (${altitude} km altitude)`;
    }

    loadOrbit();
  </script>
</body>
</html>
